---
/**
 * 404 é”™è¯¯é¡µé¢ - å›½é™…åŒ–ç‰ˆæœ¬
 * æ”¯æŒæ‰€æœ‰è¯­è¨€ï¼Œå¸¦æœ‰å¯çˆ±çš„ç¬¦å·åŠ¨ç”»
 */
import type { GetStaticPaths } from 'astro';
import Layout from '../../layouts/Layout.astro';
import { getTranslations } from '../../i18n/utils';
import { locales, type Locale } from '../../i18n/config';

export function getStaticPaths() {
  return locales.map((locale) => ({
    params: { lang: locale },
    props: { locale }
  }));
}

// Get locale from route parameters (dev mode) or props (build mode)
const locale = (Astro.props.locale || Astro.params.lang) as Locale;
const { t } = getTranslations(locale);

// 404é¡µé¢çš„å¯çˆ±ç¬¦å·
const sadSymbols = ['(ï½¡ - Ìï¸¿ - Ì€ï½¡)', '(â•¥ï¹â•¥)', '(à²¥ï¹à²¥)', '(ï½¡ - Ì -  - Ì€ï½¡)', '(â—â€¸â—Ÿ)', '(âŒ£Ì©Ì©Ì_âŒ£Ì©Ì©Ì€)'];
const randomSadSymbol = sadSymbols[Math.floor(Math.random() * sadSymbols.length)];

// å»ºè®®çš„é“¾æ¥
const suggestions = [
  { icon: 'ğŸ ', key: 'home', href: locale === 'en' ? '/' : `/${locale}/` },
  { icon: 'ğŸ“‚', key: 'categories', href: locale === 'en' ? '/categories' : `/${locale}/categories` },
  { icon: 'ğŸ“§', key: 'contact', href: locale === 'en' ? '/contact' : `/${locale}/contact` },
];

// 404é¡µé¢çš„ç¿»è¯‘æ–‡æœ¬
const translations = {
  en: {
    title: 'Oops! Page Not Found',
    description: 'The page you\'re looking for might have been moved, deleted, or never existed. But don\'t worry, we have lots of cute symbols waiting for you!',
    home: 'Go Home',
    categories: 'Browse Categories',
    contact: 'Contact Us',
    searchPlaceholder: 'Search symbols...',
    searchTip: 'ğŸ’¡ Tip: Try searching for "heart", "star", or "flower"'
  },
  fil: {
    title: 'Ay! Hindi Nakita ang Pahina',
    description: 'Maaaring inilipat, tinanggal, o hindi nagexist ang pahina na hinahanap mo. Pero huwag mag-alala, marami kaming cute symbols na naghihintay sa iyo!',
    home: 'Uwi sa Home',
    categories: 'Tingnan ang Mga Kategorya',
    contact: 'Makipag-ugnay',
    searchPlaceholder: 'Maghanap ng symbols...',
    searchTip: 'ğŸ’¡ Tip: Subukang maghanap ng "heart", "star", o "flower"'
  },
  ms: {
    title: 'Ops! Halaman Tidak Dijumpai',
    description: 'Halaman yang anda cari mungkin telah dialihkan, dipadamkan, atau tidak pernah wujud. Tetapi jangan bimbang, kami mempunyai banyak simbol comel yang menunggu anda!',
    home: 'Pergi ke Laman Utama',
    categories: 'Layari Kategori',
    contact: 'Hubungi Kami',
    searchPlaceholder: 'Cari simbol...',
    searchTip: 'ğŸ’¡ Tip: Cuba cari "heart", "star", atau "flower"'
  },
  bn: {
    title: 'à¦“à¦¹! à¦ªà§‡à¦œ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿',
    description: 'à¦†à¦ªà¦¨à¦¿ à¦¯à§‡ à¦ªà§‡à¦œà¦Ÿà¦¿ à¦–à§à¦à¦œà¦›à§‡à¦¨ à¦¤à¦¾ à¦¸à¦°à¦¾à¦¨à§‹ à¦¹à¦¯à¦¼à§‡à¦›à§‡, à¦®à§à¦›à§‡ à¦«à§‡à¦²à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡ à¦¬à¦¾ à¦•à¦–à¦¨à§‹ à¦›à¦¿à¦² à¦¨à¦¾à¥¤ à¦•à¦¿à¦¨à§à¦¤à§ à¦šà¦¿à¦¨à§à¦¤à¦¾ à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à¦¾à¦›à§‡ à¦…à¦¨à§‡à¦• à¦¸à§à¦¨à§à¦¦à¦° à¦ªà§à¦°à¦¤à§€à¦• à¦†à¦›à§‡!',
    home: 'à¦¹à§‹à¦® à¦ªà§‡à¦œà§‡ à¦¯à¦¾à¦¨',
    categories: 'à¦¬à¦¿à¦­à¦¾à¦—à¦—à§à¦²à¦¿ à¦¬à§à¦°à¦¾à¦‰à¦œ à¦•à¦°à§à¦¨',
    contact: 'à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à§à¦¨',
    searchPlaceholder: 'à¦ªà§à¦°à¦¤à§€à¦• à¦–à§à¦à¦œà§à¦¨...',
    searchTip: 'ğŸ’¡ à¦Ÿà¦¿à¦ªà¦¸: "heart", "star", à¦¬à¦¾ "flower" à¦–à§à¦à¦œà§à¦¨ à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨'
  },
  pl: {
    title: 'Ojej! Nie znaleziono strony',
    description: 'Strona, ktÃ³rej szukasz, mogÅ‚a zostaÄ‡ przeniesiona, usuniÄ™ta lub nigdy nie istniaÅ‚a. Ale nie martw siÄ™, mamy duÅ¼o sÅ‚odkich symboli!',
    home: 'Strona gÅ‚Ã³wna',
    categories: 'PrzeglÄ…daj kategorie',
    contact: 'Kontakt',
    searchPlaceholder: 'Szukaj symboli...',
    searchTip: 'ğŸ’¡ WskazÃ³wka: SprÃ³buj wyszukaÄ‡ "serce", "gwiazda" lub "kwiat"'
  }
};

const text = (translations as any)[locale];
---

<Layout title={`404 - ${t('site.title')}`} {locale}>
  <div style={{
    minHeight: '80vh',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    padding: '2rem 1rem'
  }}>
    <div style={{
      maxWidth: '600px',
      textAlign: 'center',
      animation: 'fadeIn 0.6s ease-out'
    }}>
      
      <!-- å¤§å·404 -->
      <div class="error-code" style={{
        fontSize: 'clamp(4rem, 15vw, 8rem)',
        fontWeight: 900,
        background: 'linear-gradient(135deg, var(--accent-color) 0%, #ffa07a 100%)',
        WebkitBackgroundClip: 'text',
        WebkitTextFillColor: 'transparent',
        backgroundClip: 'text',
        marginBottom: '1rem',
        letterSpacing: '-0.05em',
        lineHeight: 1
      }}>
        404
      </div>

      <!-- å¯çˆ±çš„å“­æ³£ç¬¦å· -->
      <div class="sad-symbol" style={{
        fontSize: 'clamp(2rem, 8vw, 4rem)',
        marginBottom: '1.5rem',
        animation: 'bounce 2s ease-in-out infinite'
      }}>
        {randomSadSymbol}
      </div>

      <!-- æ ‡é¢˜ -->
      <h1 style={{
        fontSize: 'clamp(1.5rem, 4vw, 2rem)',
        fontWeight: 700,
        marginBottom: '1rem',
        color: 'var(--text-primary)'
      }}>
        {t('pages.notFound.title')}
      </h1>

      <!-- æè¿° -->
      <p style={{
        fontSize: '1.125rem',
        color: 'var(--text-secondary)',
        marginBottom: '2.5rem',
        lineHeight: 1.6
      }}>
        {t('pages.notFound.description')}
      </p>

      <!-- æµ®åŠ¨çš„è£…é¥°ç¬¦å· -->
      <div class="floating-symbols" style={{
        display: 'flex',
        justifyContent: 'center',
        gap: '1rem',
        marginBottom: '2.5rem',
        fontSize: '2rem'
      }}>
        <span style={{ animation: 'float 3s ease-in-out infinite' }}>âœ¨</span>
        <span style={{ animation: 'float 3s ease-in-out infinite 0.5s' }}>ğŸ’«</span>
        <span style={{ animation: 'float 3s ease-in-out infinite 1s' }}>â­</span>
        <span style={{ animation: 'float 3s ease-in-out infinite 1.5s' }}>ğŸŒŸ</span>
        <span style={{ animation: 'float 3s ease-in-out infinite 2s' }}>âœ¨</span>
      </div>

      <!-- å»ºè®®é“¾æ¥ -->
      <div style={{
        display: 'flex',
        gap: '1rem',
        justifyContent: 'center',
        flexWrap: 'wrap',
        marginBottom: '2rem'
      }}>
        {suggestions.map((item, index) => (
          <a
            href={item.href}
            style={{
              display: 'inline-flex',
              alignItems: 'center',
              gap: '0.5rem',
              padding: '0.875rem 1.5rem',
              background: 'var(--card-bg)',
              border: '2px solid var(--accent-color)',
              borderRadius: 'var(--radius-lg)',
              color: 'var(--accent-color)',
              textDecoration: 'none',
              fontSize: '1rem',
              fontWeight: 600,
              transition: 'all 0.3s ease',
              boxShadow: 'var(--shadow-sm)',
              animation: `scaleIn 0.4s ease-out ${index * 0.1}s both`,
              opacity: 0
            }}
          >
            <span style={{ fontSize: '1.25rem' }}>{item.icon}</span>
            {text[item.key as keyof typeof text]}
          </a>
        ))}
      </div>

      <!-- æœç´¢æ¡† -->
      <div style={{
        background: 'var(--card-bg)',
        padding: '0.5rem',
        borderRadius: 'var(--radius-lg)',
        boxShadow: 'var(--shadow-md)',
        border: '1px solid var(--border-color)',
        maxWidth: '400px',
        margin: '0 auto',
        display: 'flex',
        gap: '0.5rem'
      }}>
        <input
          type="text"
          id="search-input"
          placeholder={text.searchPlaceholder}
          style={{
            flex: 1,
            border: 'none',
            outline: 'none',
            fontSize: '1rem',
            padding: '0.75rem 1rem',
            background: 'transparent',
            color: 'var(--text-primary)'
          }}
        />
        <button
          id="search-btn"
          style={{
            padding: '0.75rem 1.25rem',
            background: 'var(--accent-color)',
            color: '#ffffff',
            border: 'none',
            borderRadius: 'var(--radius-md)',
            fontSize: '1rem',
            fontWeight: 600,
            cursor: 'pointer',
            transition: 'background 0.2s ease'
          }}
        >
          ğŸ”
        </button>
      </div>

      <!-- å°æç¤º -->
      <p style={{
        marginTop: '2rem',
        fontSize: '0.875rem',
        color: 'var(--text-secondary)',
        opacity: 0.8
      }}>
        {text.searchTip}
      </p>
    </div>
  </div>

  <style>
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0) rotate(0deg);
      }
      50% {
        transform: translateY(-20px) rotate(10deg);
      }
    }

    /* é“¾æ¥æ‚¬åœæ•ˆæœ */
    a:hover {
      background: var(--accent-color) !important;
      color: #ffffff !important;
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg) !important;
    }

    /* æœç´¢æŒ‰é’®æ‚¬åœ */
    #search-btn:hover {
      background: var(--accent-hover);
      transform: scale(1.05);
    }

    /* é”™è¯¯ä»£ç åŠ¨ç”» */
    .error-code {
      animation: fadeIn 0.6s ease-out, pulse 3s ease-in-out infinite 1s;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.8;
      }
    }

    /* å“åº”å¼ */
    @media (max-width: 480px) {
      a {
        width: 100%;
        justify-content: center;
      }

      .floating-symbols {
        font-size: 1.5rem !important;
      }
    }

    /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
    @media (hover: none) and (pointer: coarse) {
      a:active {
        transform: scale(0.95);
      }
    }
  </style>

  <script define:vars={{ locale }}>
    // æœç´¢åŠŸèƒ½
    const searchInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-btn');

    function performSearch() {
      const query = searchInput.value.trim();
      if (query) {
        const basePath = locale === 'en' ? '' : `/${locale}`;
        window.location.href = `${basePath}/categories?q=${encodeURIComponent(query)}`;
      }
    }

    searchBtn.addEventListener('click', performSearch);
    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        performSearch();
      }
    });

    // è‡ªåŠ¨èšç„¦æœç´¢æ¡†ï¼ˆæ¡Œé¢ç«¯ï¼‰
    if (window.innerWidth > 768) {
      searchInput.focus();
    }
  </script>
</Layout>
