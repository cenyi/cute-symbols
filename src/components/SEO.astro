---
/**
 * SEO ç»„ä»¶ - 2026å¹´ä¼˜åŒ–ç‰ˆ
 * åŒ…å« Meta æ ‡ç­¾ã€Open Graphã€Twitter Cardã€JSON-LD ç»“æ„åŒ–æ•°æ®
 * AI å‹å¥½è®¾è®¡ï¼ˆChatGPTã€Claudeï¼‰
 */
import { getTranslations } from '../i18n/utils';
import { stats } from '../data';
import { CATEGORIES_2026 } from '../data/categories-2026';
import { type Locale } from '../i18n/config';

interface Props {
  locale?: Locale;
  title?: string;
  description?: string;
  keywords?: string;
  canonical?: string;
  ogType?: 'website' | 'article';
  ogImage?: string;
  noindex?: boolean;
}

const {
  locale = 'en',
  title,
  description,
  keywords,
  canonical,
  ogType = 'website',
  ogImage, // ç§»é™¤é»˜è®¤å€¼ï¼Œä½¿å…¶å¯é€‰
  noindex = false
} = Astro.props;

const { t } = getTranslations(locale);
const siteUrl = import.meta.env.PUBLIC_SITE_URL || 'https://cute-symbols.uk';
const currentUrl = canonical || new URL(Astro.url.pathname, siteUrl).href;

// æ„å»ºé¡µé¢æ ‡é¢˜
const pageTitle = title || t('site.title');
const fullTitle = title === t('site.title')
  ? pageTitle
  : `${pageTitle} - ${t('site.title')}`;

// æ„å»ºé¡µé¢æè¿°
const pageDescription = description || t('site.description');

// æ„å»ºå…³é”®è¯
const pageKeywords = keywords || t('seo.keywords');

// è·å–åˆ†ç±»ä¿¡æ¯ç”¨äºç»“æ„åŒ–æ•°æ®
const structuredCategories = CATEGORIES_2026.map(cat => ({
  '@type': 'Thing',
  name: cat.names[locale] || cat.names.en,
  description: cat.descriptions[locale] || cat.descriptions.en,
  keywords: ((cat.seoKeywords as any)[locale] || cat.seoKeywords.en).join(', ')
}));

// JSON-LD ç»“æ„åŒ–æ•°æ® - å¢å¼ºç‰ˆ
const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'CollectionPage',
  name: fullTitle,
  description: pageDescription,
  url: currentUrl,
  inLanguage: locale,
  about: {
    '@type': 'Thing',
    name: 'Cute Symbols',
    description: t('site.description'),
    keywords: pageKeywords
  },
  audience: {
    '@type': 'Audience',
    audienceType: ['Social media users', 'Gamers', 'Content creators', 'Instagram users', 'Roblox players', 'TikTok users', 'Discord users']
  },
  keywords: pageKeywords,
  speciality: [
    t('seo.trending2026'),
    'Aesthetic symbols',
    'Kaomoji',
    'Instagram Bio symbols',
    t('common.oneClick'),
    'Mobile optimized'
  ],
  provider: {
    '@type': 'Organization',
    name: 'Cute Symbols',
    url: siteUrl,
    ...(ogImage && {
      logo: {
        '@type': 'ImageObject',
        url: `${siteUrl}${ogImage}`
      }
    })
  },
  dateModified: stats.lastUpdated,
  datePublished: '2026-01-01',
  // GEOä¼˜åŒ–ï¼šæ·»åŠ æ›´å¤šç»“æ„åŒ–ä¿¡æ¯
  mainEntity: {
    '@type': 'ItemList',
    name: 'Cute Symbols Collection',
    description: 'Comprehensive collection of aesthetic symbols for social media',
    numberOfItems: stats.total || 1000,
    itemListElement: structuredCategories.slice(0, 5).map((cat, index) => ({
      '@type': 'ListItem',
      position: index + 1,
      item: {
        '@type': 'Thing',
        name: cat.name,
        description: cat.description
      }
    }))
  },
  // æ·»åŠ FAQç»“æ„åŒ–æ•°æ®æ”¯æŒ
  mainEntityOfPage: {
    '@type': 'WebPage',
    '@id': currentUrl
  },
  // æ·»åŠ æœç´¢åŠŸèƒ½ç»“æ„åŒ–æ•°æ®
  potentialAction: {
    '@type': 'SearchAction',
    target: {
      '@type': 'EntryPoint',
      urlTemplate: `${siteUrl}/api/symbols/search?q={search_term_string}`
    },
    'query-input': 'required name=search_term_string'
  }
};
---

<!-- Meta æ ‡ç­¾ -->
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="canonical" href={currentUrl} />

{noindex && <meta name="robots" content="noindex, nofollow" />}

<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json" />

<!-- SEO Meta æ ‡ç­¾ -->
<title>{fullTitle}</title>
<meta name="description" content={pageDescription} />
<meta name="keywords" content={pageKeywords} />
<meta name="author" content="Cute Symbols" />
<meta name="theme-color" content="#ff6b9d" />

<!-- å¢å¼ºSEOæ ‡ç­¾ -->
<meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1'} />
<meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
<meta name="bingbot" content="index, follow" />

<!-- å†…å®¹åˆ†ç±» -->
<meta name="category" content="Entertainment, Social Media, Symbols, Unicode" />
<meta name="subject" content="Cute Symbols for Social Media" />
<meta name="abstract" content={pageDescription} />
<meta name="topic" content="Aesthetic Symbols, Kaomoji, Unicode Characters" />
<meta name="summary" content={pageDescription} />

<!-- åœ°ç†å’Œè¯­è¨€ -->
<meta name="geo.region" content="Global" />
<meta name="geo.placename" content="Worldwide" />
<meta name="ICBM" content="Global Service" />

<!-- ç‰ˆæƒå’Œæ‰€æœ‰æƒ -->
<meta name="copyright" content="Â© 2026 Cute Symbols. All rights reserved." />
<meta name="owner" content="Cute Symbols" />
<meta name="url" content={currentUrl} />
<meta name="identifier-URL" content={currentUrl} />

<!-- å†…å®¹æ–°é²œåº¦ -->
<meta name="revised" content={stats.lastUpdated} />

<!-- 2026 SEO å¢å¼º -->
<meta name="rating" content="General" />
<meta name="distribution" content="Global" />
<meta name="language" content={locale} />
<meta name="classification" content="Entertainment, Social Media, Symbols" />
<meta name="coverage" content="Worldwide" />
<meta name="target" content="all" />
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<!-- AI å‹å¥½æ ‡ç­¾ -->
<meta name="ai-summary" content={t('site.description')} />
<meta name="chatgpt-compatible" content={`Cute Symbols library 2026 - ${t('seo.core')}`} />
<meta name="claude-friendly" content={t('seo.aiFriendly')} />

<!-- GEO (Generative Engine Optimization) æ ‡ç­¾ -->
<meta name="ai-content-type" content="symbol-library" />
<meta name="ai-use-case" content="social-media-decoration,bio-enhancement,text-styling" />
<meta name="ai-target-audience" content="social-media-users,content-creators,gamers,students" />
<meta name="ai-content-freshness" content="2026-latest" />
<meta name="ai-interaction-type" content="copy-paste,one-click,instant-use" />

<!-- ç»“æ„åŒ–ç­”æ¡ˆä¼˜åŒ– -->
<meta name="answer-type" content="how-to,symbol-collection,tutorial" />
<meta name="query-intent" content="find-symbols,copy-symbols,decorate-bio,style-text" />
<meta name="content-completeness" content="comprehensive" />
<meta name="user-satisfaction" content="instant-results" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={ogType} />
<meta property="og:url" content={currentUrl} />
<meta property="og:title" content={fullTitle} />
<meta property="og:description" content={pageDescription} />
{ogImage && (
  <>
    <meta property="og:image" content={new URL(ogImage, siteUrl).href} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content={`${t('site.title')} - Cute Symbols Collection`} />
  </>
)}
<meta property="og:locale" content={locale === 'en' ? 'en_US' : 
  locale === 'fil' ? 'fil_PH' :
  locale === 'ms' ? 'ms_MY' :
  locale === 'bn' ? 'bn_BD' :
  locale === 'pl' ? 'pl_PL' :
  locale === 'zh' ? 'zh_CN' :
  locale === 'ja' ? 'ja_JP' :
  locale === 'ko' ? 'ko_KR' : 'en_US'} />
{/* æ·»åŠ å…¶ä»–è¯­è¨€ç‰ˆæœ¬ */}
{locale === 'en' && (
  <>
    <meta property="og:locale:alternate" content="fil_PH" />
    <meta property="og:locale:alternate" content="ms_MY" />
    <meta property="og:locale:alternate" content="bn_BD" />
    <meta property="og:locale:alternate" content="pl_PL" />
    <meta property="og:locale:alternate" content="zh_CN" />
    <meta property="og:locale:alternate" content="ja_JP" />
    <meta property="og:locale:alternate" content="ko_KR" />
  </>
)}
<meta property="og:site_name" content="Cute Symbols" />
<meta property="og:updated_time" content={stats.lastUpdated} />

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@cutesymbols" />
<meta name="twitter:creator" content="@cutesymbols" />
<meta name="twitter:url" content={currentUrl} />
<meta name="twitter:title" content={fullTitle} />
<meta name="twitter:description" content={pageDescription} />
{ogImage && (
  <>
    <meta name="twitter:image" content={new URL(ogImage, siteUrl).href} />
    <meta name="twitter:image:alt" content={`${t('site.title')} - Copy paste cute symbols instantly`} />
  </>
)}

<!-- å¤šè¯­è¨€ hreflang -->
{(() => {
  // è·å–å½“å‰é¡µé¢è·¯å¾„ï¼ˆå»é™¤è¯­è¨€å‰ç¼€ï¼‰
  const currentPath = Astro.url.pathname;
  let basePath = currentPath;
  
  // å¦‚æœæ˜¯å¤šè¯­è¨€é¡µé¢ï¼Œå»é™¤è¯­è¨€å‰ç¼€
  const langMatch = currentPath.match(/^\/(fil|ms|bn|pl|zh|ja|ko)(\/.*)?$/);
  if (langMatch) {
    basePath = langMatch[2] || '/';
  }
  
  // ç¡®ä¿basePathä»¥/å¼€å¤´ä½†ä¸ä»¥/ç»“å°¾ï¼ˆé™¤éæ˜¯æ ¹è·¯å¾„ï¼‰
  if (basePath !== '/' && basePath.endsWith('/')) {
    basePath = basePath.slice(0, -1);
  }
  
  return (
    <>
      <link rel="alternate" hreflang="en" href={`${siteUrl}${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="fil" href={`${siteUrl}/fil${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="ms" href={`${siteUrl}/ms${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="bn" href={`${siteUrl}/bn${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="pl" href={`${siteUrl}/pl${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="zh" href={`${siteUrl}/zh${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="ja" href={`${siteUrl}/ja${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="ko" href={`${siteUrl}/ko${basePath === '/' ? '' : basePath}`} />
      <link rel="alternate" hreflang="x-default" href={`${siteUrl}${basePath === '/' ? '' : basePath}`} />
    </>
  );
})()}

<!-- JSON-LD ç»“æ„åŒ–æ•°æ® -->
<script type="application/ld+json" set:html={JSON.stringify(structuredData)}></script>

<!-- FAQ ç»“æ„åŒ–æ•°æ® (å¦‚æœæ˜¯é¦–é¡µ) -->
{Astro.url.pathname === '/' || Astro.url.pathname.match(/^\/(fil|ms|bn|pl)\/?$/) ? (
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What are cute symbols and how do I use them?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Cute symbols are special Unicode characters like hearts (ğŸ’–), stars (â­), and decorative text (âœ¨) that you can copy and paste into your social media profiles, bios, usernames, and posts. Simply click any symbol on our site to copy it instantly!"
        }
      },
      {
        "@type": "Question", 
        "name": "Which social media platforms support these symbols?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Almost all major platforms support Unicode symbols! This includes Instagram, TikTok, Twitter/X, Discord, Roblox, Facebook, WhatsApp, Telegram, YouTube, Snapchat, and many more."
        }
      },
      {
        "@type": "Question",
        "name": "Are all symbols free to use?",
        "acceptedAnswer": {
          "@type": "Answer", 
          "text": "Yes! All symbols on our website are completely free to use. They are Unicode characters that belong to the public domain. You can use them for personal or commercial purposes without any restrictions."
        }
      }
    ]
  })} />
) : null}

<!-- é¢å¤–çš„ WebSite Schema -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": t('site.title'),
  "alternateName": ["Cute Symbols 2026", "Aesthetic Symbols Library", "Kaomoji Collection"],
  "url": siteUrl,
  "description": t('site.description'),
  "potentialAction": {
    "@type": "SearchAction",
    "target": `${siteUrl}/categories?q={search_term_string}`,
    "query-input": "required name=search_term_string"
  }
})}></script>

<!-- BreadcrumbList Schema -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": t('ui.home'),
      "item": siteUrl
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": pageTitle,
      "item": currentUrl
    }
  ]
})}></script>
